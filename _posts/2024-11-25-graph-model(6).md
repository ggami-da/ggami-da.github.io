---
layout: post
title:  "[Casual Inference] Graph Model - Back door path criterion"
date:   2024-11-29
last_modified_at: 2024-11-29
categories: [Casual Inference]
tags: [Casual Inference, Data]
---

{: .box-success}
주로 분석할 때 많이 사용하는 모델 이론을 간략히 정리합니다.

# 백도어 패스 기준(back door path criterion)

앞서 Back, Front 경로에 대해서 간략히 살펴보았습니다.  
이번에는 Back Door Path를 통제하는 기준에 대해서 예시들을 통해 살펴보고자 합니다.  
**`백도어 패스 기준(back door path criterion)`**에 기반하여, 모든 백도어 패스가 치료(treatment)에서 결과(outcome)로의 경로를 차단하고 치료의 후손(descendants)을 포함하지 않는 경우 충분하다고 볼 수 있습니다. 
이 조건이 충족되면, 백도어 패스 기준을 충족시킨 것입니다.  
자, 그럼 예시를 한번 살펴봅시다.   

![img.png](../../../../img/graph-model(20).png)

치료는 A이고, 결과는 Y입니다.  
그리고 다른 변수들, V와 W를 본다면 앞선 내용처럼 V를 혼동자(confounder)로 생각할 수 있습니다.   
왜냐하면 V는 A에 직접 영향을 주고 간접적으로 Y에 영향을 미치기 때문입니다.  
그러면 A에서 Y로 정확히 하나의 백도어 패스가 있음을 보게 됩니다. 그 백도어 패스는 A_V_W_Y입니다. 
- A에서 V로 → V에서 W로 → W에서 Y로 가면서 Y에 도달할 수 있습니다. 그리고 그 **경로상에 아무런 충돌자(colliders)가 없음**을 알 수 있습니다.
결과적으로 V를 통제(차단)하면, 그 백도어 패스를 차단한 것으로 볼 수 있습니다.  
- 백도어 패스는 하나뿐이고, V를 통제함으로써 그것을 멈출 것이며, 그러면 백도어 패스 기준이 충족될 것
하지만 W를 통제할 수도 있고 만약 W를 통제할 수 있다면, 그것 또한 백도어 패스 기준을 만족시킬 것입니다.⇒ 또는 그 둘 모두를 통제할 수 있습니다. 

즉, 이 경우에는 백도어 패스 기준을 만족시킬 변수의 집합은 아래와 같습니다.

- {V}, {W}, {V,W}

보통은 일반적으로 통제할 변수의 세트를 더 작게 선호하므로,  V나 W를 하나만 선택할 수 있습니다.

![img.png](../../../../img/graph-model(21).png)

또 다른 예시를 보겠습니다.  
A에서 Y로의 백도어 패스는 A_V_M_W_Y입니다.   

- 하지만 이것은 **`충돌자`(**M)에 의해 차단됩니다.

V는 직접적으로 치료(treatment)에 영향을 줍니다. 하지만 V에서의 정보는 결코 Y로 되돌아가지 않습니다.   
마찬가지로, W는 Y에 영향을 주지만, W에서의 정보는 결코 A로 되돌아가지 않습니다.  
그래서 이 그래프에서는 실제로 혼동(confounding)이 없고 결과적으로 어떤 것도 통제할 필요가 없습니다.   
하지만 의도치 않게 어떤 경우 M을 통제할 수도 있습니다. 
- 예를 들어, 어떤 변수를 통제하고 그것이 **`충돌자(collider)`**임을 깨닫지 못할 수도 있습니다.

그렇게 하면, V와 W 사이의 경로를 열게 됩니다. 즉, V와 W는 마진(marginally)으로는 독립적이지만, 조건부로는 의존적이게 됩니다.   
이러한 경우에 통제할 변수의 집합은 아래와 같습니다. 

- {} : 첫 번째로 나열한 것은 빈 집합입니다. 그래서 다시 말하지만, 이 DAG를 기반으로 실제로 어떤 것도 통제할 필요가 없습니다.
- {V} : V를 통제할 수 있습니다. V는 충돌자가 아니므로, 그것을 통제하는 것은 편향된 의미에서 아무런 해를 끼치지 않습니다. 그래서 여러분은 V를 통제할 수 있습니다.
- {W} : 또한 W를 통제할 수 있습니다 - 해가 되지 않습니다.
- {M, W}  , {M, V}, {M, W, V} : 하지만 M을 통제한다면 V, W 또는 V와 W 둘 다를 통제해야 합니다. 그래서 혼동을 통제하기에 충분한 변수 세트의 마지막 세 가지가 M을 포함하고 그 다음 (W,V) 또는 (W,M,V)의 조합을 포함한다는 것을 볼 것입니다.

{: .box-success}
중요한 것은 위의 집합 중 어느 것이든 통제할 수 있습니다. 다만 M 하나 만을  통제하면 안됩니다. 

![img.png](../../../../img/graph-model(22).png)

마지막으로 다른 예를 살펴보겠습니다. 
A와 Y의 효과에 관심이 있고 이 경우, A에서 Y로의 두 개의 백도어 패스가 있습니다. 

- 첫 번째, A에서 Y로의 첫 번째 백도어 패스는 A_Z_V_Y입니다.
- 두 번째, A_W_Z_V_Y입니다. 

### 첫 번째 경로 A_Z_V_Y
첫 번째 경로, A_Z_V_Y에서, 특정 경로상에 충돌자가 없음을 알 수 있습니다.   
그 백도어 패스를 차단하기 위해서, Z나 V 또는 둘 다를 통제할 수 있습니다.   
다만 무조건  적어도 그들 중 하나를 통제해야 합니다. 왜냐하면 차단되지 않은 백도어 패스가 있기 때문입니다.  

### 두 번째 경로 A_W_Z_V_Y
두 번째 경로, A_W_Z_V_Y가 있습니다. 그리고 Z에서 충돌이 있음을 알 수 있습니다.  

- V와 W는 Z의 부모이기 때문에 정보는 Z에서 충돌하게 됩니다.

하지만, 만약  Z를 통제한다면 W와 V 사이에 경로를 열 것입니다. 그래서 만약 Z를 통제한다면 W와 V 사이에 경로를 열 것이며, 그것은 새로 열린 경로를 차단하기 위해 W나 V를 통제해야 함을 의미할 것입니다. 

혼동을 통제하기에 충분한 변수 세트는 다음과 같습니다. 

- {V} : V를 통제할 수 있습니다. 이야기한 첫 번째 백도어 패스를 차단하게 됩니다.
- {V, Z}, {Z, W} : 두 번째 백도어 패스는 충돌자가 있기 때문에 실제로 차단할 필요가 없습니다. V와 Z를 통제할 수도 있고, Z와 W를 통제할 수도 있습니다. (Z는 첫 번째 경로를 차단)
- {V, Z, W} : 세 개 모두를 통제할 수 있습니다.

아래는 절대 통제하면 안되는 집합입니다. 

- {Z} : 하지만, Z만을 통제하는 것으로는 충분하지 않을 것입니다. 만약 Z만 통제한다면, 그것은 W와 V 사이의 경로를 열 것이고 새로운 백도어 패스를 형성할 것입니다. 그 경로를 통해 A에서 Y로 갈 수 있습니다.
- {W} : 또한, W만을 통제해서는 안 됩니다. 만약 W만 통제한다면 여전히 차단되지 않은 백도어 패스가 있습니다. 그래서 이 경우, 최소한의 변수 세트는 V가 될 것입니다.

그래서 백도어 패스를 모두 차단하고 여전히 통제할 수 있는 가장 작은 변수는 V가 됩니다.

---
## 추가로 학습하면 좋은 부분
마지막으로 분리 원인 기준(disjunctive cause criterion)이 있습니다.  
이 방법은 치료(treatment)나 결과(outcome) 또는 둘 모두의 원인이 되는 관찰된 변수들을 선택하는 방법으로 인과 그래프의 전체를 알 필요성이 없고 치료나 결과에 영향을 주는 변수만 식별하면 되는 것이 큰 장점입니다.  

이 경우 백도어 패스 기준을 만족하는 경우도 있지만 관측하지 않은 특정 변수로 인해서 기준을 만족하지 못하는 경우도 있습니다.
단순히 분리 원인 기준에 의해서 그래프를 그리고 통제를 하였으나 실제 중간에 충돌자가 있어 백도어 패스 기준을 만족하지 못하여 비인과적인 경로를 만들 수 있습니다.  

따라서 분리 원인 기준의 사용은 연구자가 A와 Y의 모든 관찰된 원인을 정확하게 식별할 수 있다는 가정 하에, 혼동을 통제하기 위한 충분한 변수 세트를 선택할 수 있다는 보장을 제공합니다. 그러나 이는 추가적인 지식이 필요한 작업이며, 전체 인과 그래프를 알 필요는 없지만 변수들 간의 관계에 대해 어느 정도 이해가 필요합니다.  

나중에 시간이 되시면 한번 찾아서 학습해보시길 권장드립니다. ㅎㅎ

## Ref
- https://www.coursera.org/learn/crash-course-in-causality